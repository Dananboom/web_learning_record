# sual formatting model



## 9.1 introduction to the viaual formatting model

* 这节是介绍视觉格式化模型：UA是怎么在media下处理文档树的。
* 在视觉格式化模型中，在文档树的每个元素根据盒模型生成个或者更多的盒子，这些盒子的布局被以下东东控制
  * *[box dimensions](https://www.w3.org/TR/2011/REC-CSS2-20110607/box.html#box-dimensions) and [type](https://www.w3.org/TR/2011/REC-CSS2-20110607/visuren.html#box-gen).*盒子
  * *[positioning scheme](https://www.w3.org/TR/2011/REC-CSS2-20110607/visuren.html#positioning-scheme) (normal flow, float, and absolute positioning).*定位系统：流，浮动和绝对定位
  * *relationships between elements in the [document tree.](https://www.w3.org/TR/2011/REC-CSS2-20110607/conform.html#doctree)*在文档树中每个元素的关系。
  * *external information (e.g., viewport size, [intrinsic](https://www.w3.org/TR/2011/REC-CSS2-20110607/conform.html#intrinsic) dimensions of images, etc.).*外部信息，如窗口大小，图片本来的大小等等。
* 这节的属性应用于continuous media和paged media ，然而，在这节中的margin properties和在页面媒体有所不同

### 9.1.1 The biewport

* 在流媒体中的UA经常提供用户一个视口，在屏幕的一个窗口或者是其他的可视区域。
* 当视口小于渲染文档的画布区域，UA应该提供一个滚动机制，每个画布最多有一个视口，但是UA可能把一个视口渲染给多个画布（就是提供给文档多个视图）？？？

### 9.1.2 Containing blocks

许多的盒子位置都是以一个叫做containing block的矩形边缘来计算的。通常，containing block's包含后代的盒子，我们说这个盒子为他的后代建立了包含块，”a box 's containing block“意味着它所处在哪一个包含块中而不是它产生了那个包含块。

每个盒子的位置是遵循包含块的但是它可能不完全被局限在包含块里，也有可能溢出。

## 9.2 controlling box generation

这一节是描述盒子的类型，一个盒子类型的影响它在视觉格式化模型的表现，可以用display 来指定盒子的类型

### 9.2.1 block-level elements and block boxes

* 块级元素是在源文件中被看作是块的元素，例如p，display以下值的可以把元素变成块元素：block 、list-item 和table
* 块级盒子是参与格式化上下文的，每个块级元素生成一个主要的块级盒子，这个块级盒子肯包含后代和内容，并且可能参与定位系统（positioning scheme）一些块级元素可能生成额外的盒子，他们会根据主要的盒子摆放。
* 除了下节讲的表格盒子，和可替代的元素，一个块级盒子也是块级容器盒子，一个块级容器盒子要么包含一个块级盒要么者是建立一个行内格式化上下文并且只包含行内元素的盒子，不是所有的块级容器盒子都是块级盒子，replaced inline blocks 和non-replaced table cells 是块级容器盒子但是不是会计和，是块级盒子同时也是快容器盒子的叫做块级盒。

### 9.2.1.1 Anonymous block boxes

```html
<DIV>
  Some text
    <P>More text</P>
</DIV>
```

（假设div和p都是块元素，大div有inline content和块元素内容，为了好格式化，我们假设有一个匿名的盒子在”some text之间“）![1617191714298](C:\Users\Danan\AppData\Roaming\Typora\typora-user-images\1617191714298.png)

换句话说，如果一个块容器盒子（像上面的div）有块级盒子在里面，（就像上面的p）那么我们强制它只包含块级盒子，

* 当一个行内盒子包含一个文档流的块级盒子，那么这个行级盒子会被打断，如下

  ```css
  p    { display: inline }
  span { display: block } 
  ```

  ```html
  <!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN">
  <html>
  <head>
  <title>Anonymous text interrupted by a block</title>
  </head>
  <body>
     <p>
        This is anonymous text before the SPAN。
        <span>This is the content of SPAN.</span>
        This is anonymous text after the SPAN。
     </p>
  </body>
  </html>
  ```

  p元素包含一个文本c1，接着一个块元素，后面是文本c2.结果生成了一个代表body'的块级哈子，包含了围绕c1的一个匿名的块级盒子，一个叫做span的块级盒子，一个围绕c3的匿名块级盒子。

   匿名盒的继承属性会从包含它的非匿名盒那里继承（比如，在子节标题“匿名块盒”下的那个例子中的` div `盒）。匿名盒的非继承属性将取其初始值。例如，匿名盒的字体属性继承自` div `，但是外边距是` 0 `。 

   当一个元素导致了匿名块盒的生成，则该元素上设置的属性一样能应用于该元素生成的盒和该元素的内容。例如，在上面例子中，如果在` p `元素上设置了边框，则这个边框将画在` C1 `（在行的结尾开）和` C2 `（在行的结尾闭）周围。 

   计算百分比值时，应忽略匿名块盒，而以最近的非匿名祖先盒来替代。例如，上面的` div `里，如果一个匿名块盒的子盒在需要知道其包含块的高度来获得一个百分比高度。那么它将使用` div `形成的包含块的高度，而不是匿名块盒的高度。

   

  

  

  